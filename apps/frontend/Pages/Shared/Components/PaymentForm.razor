@namespace frontend.Pages.Shared.Components.PaymentForm

<div class="space-y-4">
    @if (Method is null)
    {
        <p class="text-gray-500 text-sm">
            Please select a payment method first.
        </p>
    }
    else
    {
        <EditForm OnValidSubmit="@(async () => await OnSubmit.InvokeAsync())">
            <DataAnnotationsValidator />
            <ValidationSummary />

            @switch (Method)
            {
                case "mpesa":
                    <div class="space-y-2">
                        <label class="block text-sm font-medium">M-Pesa Phone Number</label>
                        <InputText
                            @bind-Value="MpesaNumber"
                            class="w-full border rounded-lg p-2"
                            placeholder="07xx xxx xxx" />
                    </div>
                    break;

                case "card":
                    <div class="space-y-2">
                        <label class="block text-sm font-medium">Card Number</label>
                        <InputText
                            @bind-Value="CardNumber"
                            class="w-full border rounded-lg p-2"
                            placeholder="1234 5678 9012 3456" />

                        <div class="grid grid-cols-2 gap-2">
                            <div>
                                <label class="block text-sm font-medium">Expiry Date</label>
                                <InputText
                                    @bind-Value="Expiry"
                                    class="w-full border rounded-lg p-2"
                                    placeholder="MM/YY" />
                            </div>

                            <div>
                                <label class="block text-sm font-medium">CVV</label>
                                <InputText
                                    @bind-Value="Cvv"
                                    class="w-full border rounded-lg p-2"
                                    placeholder="123" />
                            </div>
                        </div>
                    </div>
                    break;

                case "paypal":
                    <div class="space-y-2">
                        <label class="block text-sm font-medium">PayPal Email</label>
                        <InputText
                            @bind-Value="PaypalEmail"
                            class="w-full border rounded-lg p-2"
                            placeholder="example@email.com" />
                    </div>
                    break;

                case "wallet":
                    <div class="space-y-2">
                        <p class="text-gray-600 text-sm">
                            Wallet balance will be used to complete this payment.
                        </p>
                    </div>
                    break;
            }

            <div class="pt-4">
                <button
                    type="submit"
                    class="w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 disabled:opacity-50"
                    disabled="@IsLoading">
                    @if (IsLoading)
                    {
                        <span>Processing...</span>
                    }
                    else
                    {
                        <span>Pay Now</span>
                    }
                </button>
            </div>
        </EditForm>
    }
</div>

@code {
    [Parameter]
    public string? Method { get; set; }

    [Parameter]
    public EventCallback OnSubmit { get; set; }

    [Parameter]
    public bool IsLoading { get; set; }

    private string MpesaNumber { get; set; } = string.Empty;
    private string CardNumber { get; set; } = string.Empty;
    private string Expiry { get; set; } = string.Empty;
    private string Cvv { get; set; } = string.Empty;
    private string PaypalEmail { get; set; } = string.Empty;
}