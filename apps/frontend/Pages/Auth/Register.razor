@page "/auth/register"
@layout PublicLayout
@inject NavigationManager Navigation

<main class="flex flex-col items-center justify-center min-h-screen bg-white px-4">
    <!-- Top Navigation -->
    <nav class="fixed top-0 left-0 right-0 z-50 bg-white shadow-md">
        <div class="max-w-6xl mx-auto px-4 py-3">
            <h1 class="font-bold text-2xl text-black">FastaBiz</h1>
        </div>
    </nav>

    <h2 class="text-3xl font-semibold mb-10 text-center">Join as a Business Owner or Customer</h2>

    <!-- Role Selection Cards -->
    <div class="flex flex-col sm:flex-row gap-6 sm:gap-10 justify-center">

        <!-- Business Owner Card -->
        <div @onclick="@(() => SelectRole("admin"))"
            class="relative cursor-pointer border rounded-lg px-8 py-6 text-center w-72 transition duration-200 ease-in-out
                    @(selectedRole == "admin" 
                        ? "border-green-600 border-4 bg-gray-50 shadow-md" 
                        : "hover:shadow-md hover:border-gray-600 border-gray-300")">
            
            @if (selectedRole == "admin")
            {
                <div class="absolute top-3 right-3 text-green-600">
                    <!-- Lucide check-circle icon SVG -->
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2l4 -4M12 22a10 10 0 1 1 0 -20a10 10 0 0 1 0 20z" />
                    </svg>
                </div>
            }

            <div class="text-5xl mb-3">üë©‚Äçüåæ</div>
            <div class="text-lg font-medium text-black">I'm a Business Owner</div>
            <div class="text-sm text-gray-500 mt-1">Hiring or listing products</div>
        </div>

        <!-- Customer Card -->
        <div @onclick="@(() => SelectRole("customer"))"
            class="relative cursor-pointer border rounded-lg px-8 py-6 text-center w-72 transition duration-200 ease-in-out
                    @(selectedRole == "customer" 
                        ? "border-green-600 border-4 bg-gray-50 shadow-md" 
                        : "hover:shadow-md hover:border-gray-600 border-gray-300")">

            @if (selectedRole == "customer")
            {
                <div class="absolute top-3 right-3 text-green-600">
                    <!-- Lucide check-circle icon SVG -->
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2l4 -4M12 22a10 10 0 1 1 0 -20a10 10 0 0 1 0 20z" />
                    </svg>
                </div>
            }

                <div class="text-5xl mb-3">üõí</div>
                <div class="text-lg font-medium text-black">I'm a Customer</div>
                <div class="text-sm text-gray-500 mt-1">Looking to buy or browse</div>
        </div>
    </div>


    <!-- Continue Button -->
    <div class="text-center mt-10">
        <button type="button"
                disabled="@string.IsNullOrEmpty(selectedRole)"
                class="px-8 py-3 rounded font-semibold transition-colors
                       @(string.IsNullOrEmpty(selectedRole) 
                         ? "bg-gray-300 text-gray-600 cursor-not-allowed" 
                         : "bg-green-600 text-white hover:bg-green-700")"
                @onclick="ProceedToRegister">
            @GetButtonText()
        </button>
    </div>

    <!-- Login Prompt -->
    <p class="text-center mt-6 text-sm text-gray-600">
        Already have an account?
        <a href="/auth/login" class="text-green-600 font-medium hover:underline">Log In</a>
    </p>
</main>


@code {
    private string selectedRole = string.Empty;

    private void SelectRole(string role)
    {
        selectedRole = role;
    }

    private string GetButtonText()
    {
        if (string.IsNullOrEmpty(selectedRole))
            return "Select a role to proceed";

        return selectedRole switch
        {
            "producer" => "Register as Business Owner",
            "customer" => "Register as Customer",
            _ => "Register"
        };
    }

    private void ProceedToRegister()
    {
        if (!string.IsNullOrEmpty(selectedRole))
        {
            Navigation.NavigateTo($"/auth/register-form?role={selectedRole}");
        }
    }
}
